function insertAtCaret(areaId,text){var txtarea=document.getElementById(areaId);var scrollPos=txtarea.scrollTop;var strPos=0;var br=((txtarea.selectionStart||txtarea.selectionStart=='0')?"ff":(document.selection?"ie":false));if(br=="ie"){txtarea.focus();var range=document.selection.createRange();range.moveStart('character',-txtarea.value.length);strPos=range.text.length;}
else if(br=="ff")strPos=txtarea.selectionStart;var front=(txtarea.value).substring(0,strPos);var back=(txtarea.value).substring(strPos,txtarea.value.length);txtarea.value=front+text+back;strPos=strPos+text.length;if(br=="ie"){txtarea.focus();var range=document.selection.createRange();range.moveStart('character',-txtarea.value.length);range.moveStart('character',strPos);range.moveEnd('character',0);range.select();}
else if(br=="ff"){txtarea.selectionStart=strPos;txtarea.selectionEnd=strPos;txtarea.focus();}
txtarea.scrollTop=scrollPos;}
function showHidden(divid){if(document.getElementById(divid).style.display=='none'){document.getElementById(divid).style.display='';}}
function hideShown(divid){if(document.getElementById(divid).style.display!='none'){document.getElementById(divid).style.display='none';}}
function Quote(postid,username){try{quote=new XMLHttpRequest();}catch(e){quote=new ActiveXObject("Microsoft.XMLHTTP")};quote.onreadystatechange=function(){if(quote.readyState==4&&quote.status==200){insertAtCaret('quickpost',"[quote="+username+"]"+quote.responseText+"[/quote]");}};if(location.href.match(/forums\.php/)){quote.open("GET","forums.php?action=get_post&post="+postid,true);}else if(location.href.match(/torrents\.php/)){quote.open("GET","torrents.php?action=get_post&post="+postid,true);}else if(location.href.match(/tvnews\.php/)){quote.open("GET","tvnews.php?action=get_post&post="+postid,true);}else if(location.href.match(/user\.php/)){quote.open("GET","user.php?action=get_post&post="+postid,true);}else if(location.href.match(/features\.php/)){quote.open("GET","features.php?action=get_post&post="+postid,true);}else if(location.href.match(/blog\.php/)){quote.open("GET","blog.php?action=get_post&post="+postid,true);}else if(location.href.match(/requests\.php/)){quote.open("GET","requests.php?action=get_post&post="+postid,true);}else{quote.open("GET","tickets.php?action=get_post&post="+postid,true);}
quote.send(null);}
function Edit_Form(postid){if(location.href.match(/forums\.php/)){pageUrl="forums";boxWidth="80";}else if(location.href.match(/torrents\.php/)){pageUrl="torrents";boxWidth="50";}else if(location.href.match(/user\.php/)){pageUrl="user";boxWidth="50";}else if(location.href.match(/tvnews\.php/)){pageUrl="tvnews";boxWidth="50";}else if(location.href.match(/features\.php/)){pageUrl="features";boxWidth="50";}else if(location.href.match(/requests\.php/)){pageUrl="requests";boxWidth="50";}else if(location.href.match(/blog\.php/)){pageUrl="blog";boxWidth="50";}else{pageUrl="tickets";boxWidth="50";}
$('bar'+postid).cancel=$('content'+postid).innerHTML;$('content'+postid).innerHTML="<div id=\"preview"+postid+"\"></div><form id=\"form"+postid+"\" method=\"post\"><input type=\"hidden\" name=\"post\" value=\""+postid+"\" /><textarea id=\"editbox"+postid+"\" name=\"body\" cols=\""+boxWidth+"\" rows=\"10\"></textarea></form>";$('bar'+postid).innerHTML="<input type=\"button\" value=\"Preview\" onclick=\"Preview_Edit("+postid+");\" /><input type=\"button\" value=\"Post\" onclick=\"Save_Edit("+postid+")\" /><input type=\"button\" value=\"Cancel\" onclick=\"Cancel_Edit("+postid+");\" />";try{editform=new XMLHttpRequest();}catch(e){editform=new ActiveXObject("Microsoft.XMLHTTP")};editform.onreadystatechange=function(){if(editform.readyState==4&&editform.status==200){var y=document.createElement('textarea');y.innerHTML=editform.responseText;$('editbox'+postid).value=y.value;}};editform.open("GET",pageUrl+".php?action=get_post&post="+postid,true);editform.send(null);}
function Cancel_Edit(postid){$('bar'+postid).innerHTML="";$('content'+postid).innerHTML=$('bar'+postid).cancel;}
function Preview_Edit(postid){$('bar'+postid).innerHTML="<input type=\"button\" value=\"Editor\" onclick=\"Cancel_Preview("+postid+");\" /><input type=\"button\" value=\"Post\" onclick=\"Save_Edit("+postid+")\" /><input type=\"button\" value=\"Cancel\" onclick=\"Cancel_Edit("+postid+");\" />";var parameters=serialize('form'+postid);try{post_req=new XMLHttpRequest();post_req.overrideMimeType('text/html');}catch(e){post_req=new ActiveXObject("Microsoft.XMLHTTP")}
post_req.onreadystatechange=function(){if(post_req.readyState==4&&post_req.status==200){$('preview'+postid).innerHTML=post_req.responseText;$('editbox'+postid).style.display="none";}};post_req.open('POST','ajax.php?action=preview',true);post_req.setRequestHeader("Content-type","application/x-www-form-urlencoded");post_req.setRequestHeader("Content-length",parameters.length);post_req.setRequestHeader("Connection","close");post_req.send(parameters);}
function Cancel_Preview(postid){$('bar'+postid).innerHTML="<input type=\"button\" value=\"Preview\" onclick=\"Preview_Edit("+postid+");\" /><input type=\"button\" value=\"Post\" onclick=\"Save_Edit("+postid+")\" /><input type=\"button\" value=\"Cancel\" onclick=\"Cancel_Edit("+postid+");\" />";$('preview'+postid).innerHTML="";$('editbox'+postid).style.display="block";}
function Save_Edit(postid){$('bar'+postid).innerHTML="";var parameters=serialize('form'+postid);try{post_sub=new XMLHttpRequest();post_sub.overrideMimeType('text/html');}catch(e){post_sub=new ActiveXObject("Microsoft.XMLHTTP")}
post_sub.onreadystatechange=function(){if(post_sub.readyState==4&&post_sub.status==200){$('content'+postid).innerHTML=post_sub.responseText;}};if(location.href.match(/forums\.php/)){post_sub.open('POST','forums.php?action=takeedit',true);}else if(location.href.match(/torrents\.php/)){post_sub.open('POST','torrents.php?action=takeedit_post',true);}else if(location.href.match(/user\.php/)){post_sub.open('POST','user.php?action=takeedit_post',true);}else if(location.href.match(/tvnews\.php/)){post_sub.open('POST','tvnews.php?action=takeedit_post',true);}else if(location.href.match(/features\.php/)){post_sub.open('POST','features.php?action=takeedit_post',true);}else if(location.href.match(/blog\.php/)){post_sub.open('POST','blog.php?action=takeedit_post',true);}else if(location.href.match(/requests\.php/)){post_sub.open("POST",'requests.php?action=takeedit_post',true);}else{post_sub.open('POST','tickets.php?action=takeedit_post',true);}
post_sub.setRequestHeader("Content-type","application/x-www-form-urlencoded");post_sub.setRequestHeader("Content-length",parameters.length);post_sub.setRequestHeader("Connection","close");post_sub.send(parameters);}
function Delete(postid,authkey){if(confirm('Are you sure you wish to delete this post?')==true){try{delpost=new XMLHttpRequest();}catch(e){delpost=new ActiveXObject("Microsoft.XMLHTTP")};delpost.onreadystatechange=function(){if(delpost.readyState==4&&delpost.status==200){$('post'+postid).style.display="none";}};if(location.href.match(/forums\.php/)){delpost.open("GET","forums.php?action=delete&auth="+authkey+"&postid="+postid,true);}else if(location.href.match(/torrents\.php/)){delpost.open("GET","torrents.php?action=delete_post&auth="+authkey+"&postid="+postid,true);}else if(location.href.match(/user\.php/)){delpost.open("GET","user.php?action=delete_post&auth="+authkey+"&postid="+postid,true);}else if(location.href.match(/tvnews\.php/)){delpost.open("GET","tvnews.php?action=delete_post&auth="+authkey+"&postid="+postid,true);}else if(location.href.match(/features\.php/)){delpost.open("GET","features.php?action=delete_post&auth="+authkey+"&postid="+postid,true);}else if(location.href.match(/blog\.php/)){delpost.open("GET","blog.php?action=delete_post&auth="+authkey+"&postid="+postid,true);}else if(location.href.match(/requests\.php/)){delpost.open("GET","requests.php?action=delete_post&auth="+authkey+"&postid="+postid,true);}else{delpost.open("GET","tickets.php?action=delete_post&auth="+authkey+"&postid="+postid,true);}
delpost.send(null);}}
function Quick_Preview(){document.getElementById('quickreplybuttons').innerHTML="<input type=\"button\" value=\"Editor\" onclick=\"Quick_Edit();\" /><input type=\"submit\" value=\"Submit\" />";var input=document.getElementById('quickpost');var inDiv=document.getElementById('quickreplytext');var outDiv=document.getElementById('quickreplypreview');jQuery.post('/ajax.php',{action:'preview',body:input.value},function(res){outDiv.innerHTML=res;outDiv.style.display="block";inDiv.style.display="none";},'html');}
function Quick_Edit(){$('quickreplybuttons').innerHTML="<input type=\"button\" value=\"Preview\" onclick=\"Quick_Preview();\" /><input type=\"submit\" value=\"Submit\" />";$('quickreplypreview').style.display="none";$('quickreplytext').style.display="block";}