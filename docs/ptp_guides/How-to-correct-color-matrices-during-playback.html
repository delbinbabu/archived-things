<!DOCTYPE html>
<!-- saved from url=(0056)https://passthepopcorn.me/wiki.php?action=article&id=235 -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	
	<meta http-equiv="X-UA-Compatible" content="chrome=1;IE=edge">
		<meta name="referrer" content="no-referrer">
	<meta name="referrer" content="same-origin">
	<meta name="robots" content="noindex">
		<title>How to correct color matrices during playback :: PassThePopcorn</title>
	<link rel="shortcut icon" href="https://ptp.me/favicon.ico">
	<link rel="apple-touch-icon" href="https://ptp.me/static/common/touch-icon-iphone.png?v=1514440441">
	<link rel="apple-touch-icon" sizes="72x72" href="https://ptp.me/static/common/touch-icon-ipad.png?v=1514440441">
	<link rel="apple-touch-icon" sizes="114x114" href="https://ptp.me/static/common/touch-icon-iphone-retina.png?v=1514440441">
	<link rel="search" type="application/opensearchdescription+xml" title="PassThePopcorn" href="https://ptp.me/static/opensearch.xml">
	
	
	
		
	
	
	
	
	
	
	
	
				<link href="./How-to-correct-color-matrices-during-playback_files/marcel.css" rel="stylesheet" type="text/css" media="screen">
						<script src="./How-to-correct-color-matrices-during-playback_files/script_start.js.download" type="text/javascript"></script>
						<script src="./How-to-correct-color-matrices-during-playback_files/class_ajax.js.download" type="text/javascript"></script>
						<script src="./How-to-correct-color-matrices-during-playback_files/global.js.download" type="text/javascript"></script>
							<script src="./How-to-correct-color-matrices-during-playback_files/jquery.js.download" type="text/javascript"></script>
						<script src="./How-to-correct-color-matrices-during-playback_files/autocomplete.js.download" type="text/javascript"></script>
					<script src="./How-to-correct-color-matrices-during-playback_files/wiki.js.download" type="text/javascript"></script>
					<script src="./How-to-correct-color-matrices-during-playback_files/bbcode.js.download" type="text/javascript"></script>
					<script src="./How-to-correct-color-matrices-during-playback_files/mousetrap.min.js.download" type="text/javascript"></script>
		</head>
<body id="wiki" data-anticsrftoken="9001" style="">
<div id="wrapper">
	<div id="header" class="header">
		<div class="site-logo"><a class="site-logo__link" href="https://ptp.me/index.php"></a></div>
				
			<div class="main-menu">
			<ul class="main-menu__list">
				<li class="main-menu__item" id="nav_index"><a class="main-menu__link" href="https://ptp.me/index.php">Home</a></li>
				<li class="main-menu__item" id="nav_torrents"><a class="main-menu__link" href="https://ptp.me/torrents.php">Movies</a></li>
				<li class="main-menu__item" id="nav_collages"><a class="main-menu__link" href="https://ptp.me/collages.php">Collections</a></li>
				<li class="main-menu__item" id="nav_requests"><a class="main-menu__link" href="https://ptp.me/requests.php">Requests</a></li>
				<li class="main-menu__item" id="nav_forums"><a class="main-menu__link" href="https://ptp.me/forums.php">Forums</a></li>
				<li class="main-menu__item" id="nav_irc"><a class="main-menu__link" href="https://ptp.me/wiki.php?action=article&amp;id=95">Chat</a></li>
				<li class="main-menu__item" id="nav_top10"><a class="main-menu__link" href="https://ptp.me/top10.php">Top&nbsp;10</a></li>
				<li class="main-menu__item" id="nav_rules"><a class="main-menu__link" href="https://ptp.me/rules.php">Rules</a></li>
				<li class="main-menu__item" id="nav_wiki"><a class="main-menu__link" href="https://ptp.me/wiki.php">Wiki</a></li>
				<li class="main-menu__item" id="nav_staff"><a class="main-menu__link" href="https://ptp.me/staff.php">Staff</a></li>
			</ul>
		</div>
				<div class="search-bar">
			<ul class="search-bar__list">
				<li id="searchbar_torrents" class="search-bar__search-field">
					<form action="https://passthepopcorn.me/torrents.php" method="get" class="search-bar__search-field__form">
												<input type="hidden" name="order_by" value="relevance">
						<input id="torrentssearch" class="search-bar__search-field__input" onkeyup="autocomp.keyup(event);" onkeydown="autocomp.keydown(event);" accesskey="m" spellcheck="false" autocomplete="off" onfocus="autocomp.start(&#39;torrents&#39;);" onblur="" placeholder="Movies" type="text" name="searchstr" size="17">
						<ul id="torrentscomplete" class="search-bar__results hidden"></ul>
					</form>
				</li>
				<li id="searchbar_people" class="search-bar__search-field">
					<form action="https://passthepopcorn.me/artist.php" method="get" class="search-bar__search-field__form">
						<input id="artistsearch" class="search-bar__search-field__input" onkeyup="autocomp.keyup(event);" onkeydown="autocomp.keydown(event);" accesskey="p" spellcheck="false" autocomplete="off" onfocus="autocomp.start(&#39;artist&#39;);" placeholder="People" type="text" name="artistname" size="17">
						<ul id="artistcomplete" class="search-bar__results hidden"></ul>
					</form>
				</li>
				<li id="searchbar_collections" class="search-bar__search-field">
					<form action="https://passthepopcorn.me/collages.php" method="get" class="search-bar__search-field__form">
						<input class="search-bar__search-field__input" accesskey="c" spellcheck="false" id="collectionsearch" placeholder="Collections" type="text" name="search" size="17">
					</form>
				</li>
				<li id="searchbar_requests" class="search-bar__search-field">
					<form action="https://passthepopcorn.me/requests.php" method="get" class="search-bar__search-field__form">
						<input class="search-bar__search-field__input" accesskey="r" spellcheck="false" placeholder="Requests" type="text" name="search" size="17">
					</form>
				</li>
				<li id="searchbar_forums" class="search-bar__search-field">
					<form action="https://passthepopcorn.me/forums.php" method="get" class="search-bar__search-field__form">
						<input value="search" type="hidden" name="action">
						<input class="search-bar__search-field__input" accesskey="f" spellcheck="false" placeholder="Forums" type="text" name="search" size="17">
					</form>
				</li>
				<li id="searchbar_log" class="search-bar__search-field">
					<form action="https://passthepopcorn.me/log.php" method="get" class="search-bar__search-field__form">
						<input class="search-bar__search-field__input" accesskey="l" spellcheck="false" placeholder="Log" type="text" name="search" size="17">
					</form>
				</li>
				<li id="searchbar_users" class="search-bar__search-field">
					<form action="https://passthepopcorn.me/user.php" method="get" class="search-bar__search-field__form">
						<input type="hidden" name="action" value="search">
						<input class="search-bar__search-field__input" accesskey="u" spellcheck="false" placeholder="Users" type="text" name="search" size="17">
					</form>
				</li>
			</ul>
		</div>
	</div>
		<div id="content" class="page__main-content">
<div class="thin">
	<h2 class="page__title">How to correct color matrices during playback</h2>
		<div class="linkbox">
		<a class="linkbox__link" href="https://ptp.me/wiki.php?action=create">[Create]</a>
		<a class="linkbox__link" href="https://ptp.me/wiki.php?action=edit&amp;id=235">[Contribute]</a>
<a class="linkbox__link" href="https://ptp.me/wiki.php?action=revisions&amp;id=235">[History]</a>
	</div>
	<div class="sidebar">
		<div class="panel">
			<div class="panel__body">
				<form action="https://passthepopcorn.me/wiki.php" method="get">
					<input type="hidden" name="action" value="search">
					<input placeholder="Search articles" type="text" name="search" size="20">
					<input value="Search" type="submit" class="hidden">
				</form>
				<br>
				<a href="https://ptp.me/wiki.php?action=search&amp;type=Title&amp;order=Title&amp;way=Ascending">List all articles</a>
			</div>
		</div>
		<div class="panel">
			<div class="panel__body">
				<ul class="list list--unstyled">
					<li>
						<strong>Protection:</strong>
						<ul class="list--bulleted list--small-padding">
							<li>Read: Abuser</li>
							<li>Edit: Power User</li>
						</ul>
					 </li>
					<li>
						<strong>Details:</strong>
						<ul class="list--bulleted list--small-padding">
							<li>Version: 15</li>
							<li>Last edited by: <a class="username" href="https://ptp.me/user.php?id=75308">pafnucy</a></li>
							<li>Last updated: <span class="time" title="Jun 03 2017, 09:57">[ Jun 03 2017, 09:57 ]</span></li>
						</ul>
					</li>
					<li>
						<strong>Aliases:</strong>
						<ul class="list--bulleted list--small-padding">
																		<li id="alias_howtocorrectcolormatricesduringplayback">
												<a href="https://ptp.me/wiki.php?action=article&amp;name=howtocorrectcolormatricesduringplayback">howtocorrectcolormat...</a>
																							</li>
																</ul>
					</li>
				</ul>
			</div>
		</div>
					<div class="panel">
				<div class="panel__body">
					<form action="https://passthepopcorn.me/wiki.php" method="post">
						<input type="hidden" name="AntiCsrfToken" value="9001">						<input type="hidden" name="action" value="add_alias">
						<input type="hidden" name="article" value="235">
						<input placeholder="Add alias" type="text" name="alias" size="20">
						<input type="submit" value="+">
					</form>
				</div>
			</div>
			</div>
	<div class="main-column">
	<div class="panel">
		<div class="panel__body"><span class="bbcode-size-4">Introduction</span><br>
<br>
Encodes made from Blu-rays should be displayed with the BT709 color matrix, while encodes made from DVDs should use BT601.<br>
<br>
Most video players will try to automatically determine the correct color matrix of the file being played. Typically it works like this:<br>
<br>
1. Check if the video has an embedded colormatrix tag, use it<br>
2. If no tag is found, assume BT709 for HD resolution and BT601 for SD resolution<br>
<br>
This works most of the time, <em>except</em> for Blu-ray sourced SD encodes that fail to include the colormatrix tag. In that case, virtually all players will assume the video comes from a DVD based on the resolution and apply the incorrect BT601 color matrix. Unfortunately, a lot of Blu-ray sourced SD encodes on PTP fall under that case.<br>
<br>
This mistake is not easily spotted as comparisons in avspmod will always use the same matrix for the resized source and the encode. The difference will be only noticeable on playback, when the video player tries to guess or apply the tag embedded during the encoding process.<br>
<br>
Example: <strong>Incorrect, Correct</strong>: <a href="https://ptp.me/wiki.php?action=article&amp;id=235#" onclick="BBCode.ScreenshotComparisonToggleShow( this, [&quot;Incorrect&quot;,&quot; Correct&quot;], [&quot;https:\/\/ptpimg.me\/dg41dy.png&quot;,&quot;https:\/\/ptpimg.me\/h40d0w.png&quot;,&quot;https:\/\/ptpimg.me\/0qj8g1.png&quot;,&quot;https:\/\/ptpimg.me\/8gsm03.png&quot;,&quot;https:\/\/ptpimg.me\/e8m1yl.png&quot;,&quot;https:\/\/ptpimg.me\/tqh2yv.png&quot;] ); return false;">Show comparison</a><br>
<br>
<blockquote><strong>Note:</strong> HANDJOB encodes are typically unaffected, as Handbrake adds the appropriate tags automatically.</blockquote><br>
<span class="bbcode-size-4">How can I tell if my video uses an incorrect color matrix?</span><br>
<br>
1. Make sure your encode is sourced from a Blu-ray and is in Standard Definition. Click on the file name to expand the Mediainfo.<br>
<img class="bbcode__image" onclick="lightbox.init(this,500);" alt="https://i.ibb.co/0DvXQcX/bgc6d0.png" src="./How-to-correct-color-matrices-during-playback_files/bgc6d0.png"><br>
<br>
2. In the Video section, look for the line "Matrix coefficients : BT.709".<br>
<img class="bbcode__image" onclick="lightbox.init(this,500);" alt="https://i.ibb.co/FbjgCHN/7me900.png" src="./How-to-correct-color-matrices-during-playback_files/7me900.png"><br>
If you can find it there, <strong>all is good</strong>. Close this page and enjoy the movie. If it is missing, you might have to correct it.<br>
<br>
It is possible, although unlikely, that the encoder transformed the color matrix so it would be correctly played as bt601 but left it untagged. Read the torrent description and use your own eyes to make sure the correction is needed.<br>
<br>
<span class="bbcode-size-4">How do I correct the color matrix on playback?</span><br>
<br>
If you downloaded an untagged Blu-ray-sourced SD encode you can override your video player's settings to display it correctly. <br>
<span style="text-decoration: underline;">Remember to turn it off when you are done.</span><br>
<br>
<strong>If you use standard mpc-hc (LAV Filters)</strong>: <a href="javascript:void(0);" onclick="BBCode.spoiler(this);">Show</a><blockquote class="hidden spoiler">1. Open View - Options<br>
2. Click on Output under Playback and make sure that you use a shaders-capable renderer (e.g. Enhanced Video Renderer custom presenter)<br>
3. Click on Shaders under Playback<br>
4. Select BT.601 to BT.709, click Add to post-resize and click OK.<br>
<img class="bbcode__image" onclick="lightbox.init(this,500);" alt="https://i.ibb.co/j62HP60/1im264.png" src="./How-to-correct-color-matrices-during-playback_files/1im264.png"><br>
</blockquote><br>
<br>
<strong>If you use mpc-hc+madVR</strong>: <a href="javascript:void(0);" onclick="BBCode.spoiler(this);">Show</a><blockquote class="hidden spoiler">Press Ctrl+Shift+Alt+M to switch between color matrices.<br>
</blockquote><br>
<br>
<strong>If you use mpc-hc+Haali Video Renderer</strong>: <a href="javascript:void(0);" onclick="BBCode.spoiler(this);">Show</a><blockquote class="hidden spoiler"> If you are using Haali Video Renderer in 2015 you should probably consider migrating to LAV Filters or madVR, but you can correct the color matrix all the same.<br>
<br>
1. Open Play - Filters - Haali Video Renderer<br>
2. Select BT.709 and click OK.<br>
<img class="bbcode__image" onclick="lightbox.init(this,500);" alt="https://i.ibb.co/4N9XcMv/xo91gt.png" src="./How-to-correct-color-matrices-during-playback_files/xo91gt.png"></blockquote><br>
<br>
<strong>If you use Potplayer</strong>: <a href="javascript:void(0);" onclick="BBCode.spoiler(this);">Show</a><blockquote class="hidden spoiler">1. Right click on the video to open the menu<br>
2. Select Video - Pixel Shader - Post Resize Pixel Shaders - BT601BT709 </blockquote><br>
<br>
<strong>If you use VLC (on Windows)</strong>: <a href="javascript:void(0);" onclick="BBCode.spoiler(this);">Show</a><blockquote class="hidden spoiler"><strong>Note: VLC apparently ignores the color matrix tag so you have to do the following every time you want to watch an SD encode made from a Blu-ray, regardless of the way it was tagged. </strong><br>
<br>
1. Open Tools - Preferences<br>
2. Click on Show All<br>
3. Click on Video - Output modules - Direct3D<br>
4. Select Pixel Shader - Convert 601to709 and save<br>
<img class="bbcode__image" onclick="lightbox.init(this,500);" alt="https://i.ibb.co/2Y00XJv/m211v5.png" src="./How-to-correct-color-matrices-during-playback_files/m211v5.png">   </blockquote><br>
<br>
<span class="bbcode-size-4">Appendix: I am an encoder. How do I make sure my Blu-ray-sourced SD encodes are correct?</span><br>
<br>
There are two strategies you can adopt. There is no clear consensus which one is better. Tagging as bt709 is foolproof and covers the majority of players, while converting to bt601 and tagging as bt601 ensures wider compatibility but is a bit more involved. In addition, the color primaries should be defined. Tagging the transfer characteristics is not necessary.<br>
<br>
<strong>Tag as BT709</strong>: <a href="javascript:void(0);" onclick="BBCode.spoiler(this);">Show</a><blockquote class="hidden spoiler">1. Add  <code>--colormatrix bt709 --colorprim bt709</code> to your x264 parameters<br>
</blockquote><br>
<br>
OR<br>
<br>
<strong>Convert to BT601 and tag it as such</strong>: <a href="javascript:void(0);" onclick="BBCode.spoiler(this);">Show</a><blockquote class="hidden spoiler"><br>
Only do this if you understand what you are doing! An <span style="text-decoration: underline;">example</span> follows:<br>
<br>
1. In avisynth:<br>
<br>
dither_convert_yuv_to_rgb(output="rgb48y",chromak="spline36",matrix="709",lsb_in=false) #convert to 48bit RGB (interleaved 16b y8)<br>
#if you are doing some debanding, do it here in 16 bit<br>
dither_resize16(854,480,kernel="spline36") #resize<br>
dither_convert_rgb_to_yuv(selectevery(3,0),selectevery(3,1),selectevery(3,2),chromak="spline36",matrix="601",lsb=false,mode=6) #convert and dither back to 8 bit yuv (if you did any debanding you can add grain here with ampn=x,staticnoise=false)<br>
<br>
2. Add  <code>--colormatrix bt470bg --colorprim bt709</code> to your x264 parameters<br>
3. Mention in the torrent description that you converted the matrix<br>
 </blockquote><br>
<br>
<span class="bbcode-size-4">What about DVDs?</span><br>
To be on the safe side, tag them in the following way:<br>
<br>
PAL: <code>--colormatrix bt470bg --colorprim bt470bg</code><br>
NTSC: <code>--colormatrix smpte170m --colorprim smpte170m</code><br>
<br>
<span class="bbcode-size-4">References</span><br>
<a rel="noreferrer" target="_blank" href="https://www.itu.int/dms_pubrec/itu-r/rec/bt/R-REC-BT.601-7-201103-I!!PDF-E.pdf">https://www.itu.int/dms_pubrec/itu-r/rec/bt/R-REC-BT.601-7-201103-I!!PDF-E.pdf</a><br>
<a rel="noreferrer" target="_blank" href="https://www.itu.int/rec/T-REC-H.264">https://www.itu.int/rec/T-REC-H.264</a></div>
	</div>
	</div>
</div>
	</div>
	
</div>
<div id="lightbox" class="lightbox hidden" tabindex="-1"></div>
<div id="lightbox__shroud" class="lightbox__shroud hidden"></div>

<!-- Extra divs, for stylesheet developers to add imagery -->
<div id="extra1"><span></span></div>
<div id="extra2"><span></span></div>
<div id="extra3"><span></span></div>
<div id="extra4"><span></span></div>
<div id="extra5"><span></span></div>
<div id="extra6"><span></span></div>


</body></html>